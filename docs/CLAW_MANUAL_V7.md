# Claw v7.0 運用マニュアル (Orchestration & Reverse Sync)

## 1. 開発フロー概要

本プロジェクトでは、設計者（Antigravity）と実装者（Claude Code）が連動し、設計とコードを常に一致させながら高速開発を行います。

## 2. 司令塔（Antigravity）のプロトコル

- **タスク分割**: `docs/design.md` から優先順位を判断し、`internal/` 以下のレイヤーごとにタスクを切り出す。
- **長時間待機**: `claude -p` を使用する際は、バックグラウンドでの「深考」を妨げず、最大60分まで監視を継続する。
- **生存確認**: 標準出力がなくても、ファイルシステムの変更（`list_dir`）を30秒〜60秒おきに行い、進捗を測る。

## 3. 実装依頼のコマンド規約

バックグラウンド作業を中断させないため、以下のフラグを標準とする。

- `-p`: 非対話モードで実行。
- `--dangerously-skip-permissions`: ツール実行時の確認プロンプトをスキップ。

## 4. 逆同期 (Reverse Sync) の手順

1. Claude Code から実装が戻る。
2. Antigravity がソースコードを読み込み、設計書（`docs/design.md`）にない新しい工夫や改善点（新しい定数、エラー体系、Builderパターン等）を抽出する。
3. Antigravity が `docs/design.md` の該当箇所を、実際の実装に合わせて書き換える。
4. これにより「常に設計書が最新の実装を正しく表現している」状態を維持する。
